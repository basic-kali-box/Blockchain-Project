{% extends "layout.html" %}

{% block title %}Tableau de bord - Traçabilité Blockchain{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h1>Tableau de bord</h1>
        <p class="lead">Bienvenue, {{ user_info.organization }} ({{ user_info.role }})</p>
    </div>
</div>

<div class="row">
    <div class="col-lg-4">
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">Informations de votre compte</h5>
            </div>
            <div class="card-body">
                <p><strong>Nom d'utilisateur:</strong> {{ session.get('username') }}</p>
                <p><strong>Rôle:</strong> {{ user_info.role }}</p>
                <p><strong>Organisation:</strong> {{ user_info.organization }}</p>
                <p><strong>ID utilisateur:</strong> {{ user_info.user_id }}</p>
            </div>
        </div>
    </div>
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">Actions rapides</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <a href="/ui/register_product" class="btn btn-outline-success w-100 py-3">
                            <div class="d-flex flex-column align-items-center">
                                <span class="h5">Enregistrer un produit</span>
                                <span class="text-muted">Ajouter un nouveau produit à la blockchain</span>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-6 mb-3">
                        <a href="/ui/transfer_product" class="btn btn-outline-success w-100 py-3">
                            <div class="d-flex flex-column align-items-center">
                                <span class="h5">Transférer un produit</span>
                                <span class="text-muted">Transférer un produit à un autre acteur</span>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-6 mb-3">
                        <a href="/ui/search" class="btn btn-outline-success w-100 py-3">
                            <div class="d-flex flex-column align-items-center">
                                <span class="h5">Rechercher un produit</span>
                                <span class="text-muted">Consulter l'historique d'un produit</span>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-6 mb-3">
                        <a href="/chain" class="btn btn-outline-success w-100 py-3" target="_blank">
                            <div class="d-flex flex-column align-items-center">
                                <span class="h5">Voir la blockchain</span>
                                <span class="text-muted">Consulter tous les blocs de la chaîne</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header bg-light">
                <h5 class="mb-0">Informations sur la blockchain</h5>
            </div>
            <div class="card-body">
                <p><strong>Longueur de la blockchain:</strong> {{ blockchain_length }} blocs</p>
                
                <div class="mt-4">
                    <h6>Vos clés cryptographiques (pour démonstration uniquement)</h6>
                    <div class="alert alert-warning">
                        <p class="mb-0"><small>Dans un environnement de production, votre clé privée ne serait jamais affichée et serait stockée de manière sécurisée.</small></p>
                    </div>
                    
                    <div class="accordion" id="keysAccordion">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingPublicKey">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePublicKey" aria-expanded="false" aria-controls="collapsePublicKey">
                                    Votre clé publique
                                </button>
                            </h2>
                            <div id="collapsePublicKey" class="accordion-collapse collapse" aria-labelledby="headingPublicKey" data-bs-parent="#keysAccordion">
                                <div class="accordion-body">
                                    <pre class="bg-light p-2" style="overflow-x: auto;"><code>{{ demo_info.public_key }}</code></pre>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingPrivateKey">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePrivateKey" aria-expanded="false" aria-controls="collapsePrivateKey">
                                    Votre clé privée (ne jamais partager)
                                </button>
                            </h2>
                            <div id="collapsePrivateKey" class="accordion-collapse collapse" aria-labelledby="headingPrivateKey" data-bs-parent="#keysAccordion">
                                <div class="accordion-body">
                                    <pre class="bg-light p-2" style="overflow-x: auto;"><code>{{ demo_info.private_key }}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
